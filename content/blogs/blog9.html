---
categories:
- ""
- ""
date: "2017-10-31T21:28:43-05:00"
#description: ""
draft: false
image: Connected World.jpg
keywords: ""
slug: blog9
#title: Ipsum
---



<div id="general-social-survey-gss" class="section level1">
<h1>General Social Survey (GSS)</h1>
<p>The <a href="http://www.gss.norc.org/">General Social Survey (GSS)</a> gathers data on American society in order to monitor and explain trends in attitudes, behaviours, and attributes. Many trends have been tracked for decades, so one can see the evolution of attitudes, etc in American Society.</p>
<p>In this assignment we analyze data from the <strong>2016 GSS sample data</strong>, using it to estimate values of <em>population parameters</em> of interest about US adults. The GSS sample data file has 2867 observations of 935 variables, but we are only interested in very few of these variables and you are using a smaller file.</p>
<pre class="r"><code>gss &lt;- read_csv(here::here(&quot;data&quot;, &quot;smallgss2016.csv&quot;), 
                na = c(&quot;&quot;, &quot;Don&#39;t know&quot;,
                       &quot;No answer&quot;, &quot;Not applicable&quot;))

skim(gss)</code></pre>
<table>
<caption>(#tab:read_gss_data)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">gss</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">2867</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">7</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emailmin</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">15</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emailhr</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">42</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">snapchat</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">instagrm</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">twitter</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">degree</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>You will also notice that many responses should not be taken into consideration, like “No Answer”, “Don’t Know”, “Not applicable”, “Refused to Answer”.</p>
<p>We will be creating 95% confidence intervals for population parameters. The variables we have are the following:</p>
<ul>
<li>hours and minutes spent on email weekly. The responses to these questions are recorded in the <code>emailhr</code> and <code>emailmin</code> variables. For example, if the response is 2.50 hours, this would be recorded as emailhr = 2 and emailmin = 30.</li>
<li><code>snapchat</code>, <code>instagrm</code>, <code>twitter</code>: whether respondents used these social media in 2016</li>
<li><code>sex</code>: Female - Male</li>
<li><code>degree</code>: highest education level attained</li>
</ul>
<div id="instagram-and-snapchat-by-sex" class="section level2">
<h2>Instagram and Snapchat, by sex</h2>
<p>Can we estimate the <em>population</em> proportion of Snapchat or Instagram users in 2016?</p>
<pre class="r"><code>gss_tidy &lt;- gss %&gt;% 
  mutate(snap_insta = case_when(
    instagrm == &quot;Yes&quot; | snapchat == &quot;Yes&quot; ~ &quot;Yes&quot;,
    instagrm == &quot;No&quot; | snapchat == &quot;No&quot; ~ &quot;No&quot;,
    instagrm == &quot;NA&quot; &amp; snapchat == &quot;NA&quot; ~ &quot;NA&quot;))

gss_tidy %&gt;%
summarise(snap_insta_proportion=count(snap_insta == &quot;Yes&quot;)/count(snap_insta, na.rm ==TRUE))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   snap_insta_proportion
##                   &lt;dbl&gt;
## 1                 0.344</code></pre>
<pre class="r"><code>formula_ci_social_media &lt;- gss_tidy %&gt;%
  group_by(sex) %&gt;% 
  summarise(mean_snap_insta_yes = mean(snap_insta == &quot;Yes&quot;),
          sd_snap_insta = sd(snap_insta  == &quot;Yes&quot;),
          count = n(),
          se_snap_insta = sd_snap_insta/sqrt(count),
          t_critical = qt(0.975, count - 1),
          lower_bound = mean_snap_insta_yes - t_critical * se_snap_insta,
          upper_bound = mean_snap_insta_yes + t_critical * se_snap_insta)

formula_ci_social_media</code></pre>
<pre><code>## # A tibble: 2 x 8
##   sex   mean_snap_insta… sd_snap_insta count se_snap_insta t_critical
##   &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;         &lt;dbl&gt;      &lt;dbl&gt;
## 1 Fema…            0.202         0.402  1591        0.0101       1.96
## 2 Male             0.150         0.358  1276        0.0100       1.96
## # … with 2 more variables: lower_bound &lt;dbl&gt;, upper_bound &lt;dbl&gt;</code></pre>
<ol style="list-style-type: decimal">
<li>Create a new variable, <code>snap_insta</code> that is <em>Yes</em> if the respondent reported using any of Snapchat (<code>snapchat</code>) or Instagram (<code>instagrm</code>), and <em>No</em> if not. If the recorded value was NA for both of these questions, the value in your new variable should also be NA. #done</li>
<li>Calculate the proportion of Yes’s for <code>snap_insta</code> among those who answered the question, i.e. excluding NAs.</li>
<li>Using the CI formula for proportions, please construct 95% CIs for men and women who used either Snapchat or Instagram</li>
</ol>
</div>
<div id="twitter-by-education-level" class="section level2">
<h2>Twitter, by education level</h2>
<p>Can we estimate the <em>population</em> proportion of Twitter users by education level in 2016?</p>
<p>There are 5 education levels in variable <code>degree</code> which, in ascending order of years of education, are Lt high school, High School, Junior college, Bachelor, Graduate.</p>
<ol style="list-style-type: decimal">
<li>Turn <code>degree</code> from a character variable into a factor variable. Make sure the order is the correct one and that levels are not sorted alphabetically which is what R by default does.</li>
</ol>
<pre class="r"><code>factor_degree&lt;-factor(gss_tidy$degree, ordered=TRUE, levels = c(&quot;Lt high school&quot;, &quot;High School&quot;, &quot;Junior college&quot;, &quot;Bachelor&quot;, &quot;Graduate&quot;))

levels(factor_degree)</code></pre>
<pre><code>## [1] &quot;Lt high school&quot; &quot;High School&quot;    &quot;Junior college&quot; &quot;Bachelor&quot;      
## [5] &quot;Graduate&quot;</code></pre>
<pre class="r"><code>glimpse(factor_degree)</code></pre>
<pre><code>##  Ord.factor w/ 5 levels &quot;Lt high school&quot;&lt;..: 4 NA 4 NA 5 3 NA NA NA 3 ...</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Create a new variable, <code>bachelor_graduate</code> that is <em>Yes</em> if the respondent has either a <code>Bachelor</code> or <code>Graduate</code> degree. As before, if the recorded value for either was NA, the value in your new variable should also be NA.</li>
</ol>
<pre class="r"><code>gss_tidy &lt;- gss_tidy %&gt;% 
  mutate(bachelor_graduate = case_when(
    factor_degree == &quot;Bachelor&quot; | factor_degree == &quot;Graduate&quot; ~ &quot;Yes&quot;,
    factor_degree == &quot;NA&quot; ~ &quot;NA&quot;
  ))
  
gss_tidy</code></pre>
<pre><code>## # A tibble: 2,867 x 9
##    emailmin emailhr snapchat instagrm twitter sex   degree snap_insta
##    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     
##  1 0        12      NA       NA       NA      Male  Bache… NA        
##  2 30       0       No       No       No      Male  High … No        
##  3 NA       NA      No       No       No      Male  Bache… No        
##  4 10       0       NA       NA       NA      Fema… High … NA        
##  5 NA       NA      Yes      Yes      No      Fema… Gradu… Yes       
##  6 0        2       No       Yes      No      Fema… Junio… Yes       
##  7 0        40      NA       NA       NA      Male  High … NA        
##  8 NA       NA      Yes      Yes      No      Fema… High … Yes       
##  9 0        0       NA       NA       NA      Male  High … NA        
## 10 NA       NA      No       No       No      Male  Junio… No        
## # … with 2,857 more rows, and 1 more variable: bachelor_graduate &lt;chr&gt;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the proportion of <code>bachelor_graduate</code> who do (Yes) and who don’t (No) use twitter.</li>
</ol>
<pre class="r"><code>gss_tidy %&gt;% 
  filter(bachelor_graduate == &quot;Yes&quot;) %&gt;% 
  summarise(prop_yes=count(twitter == &quot;Yes&quot;)/count(bachelor_graduate == &quot;Yes&quot; &amp; twitter != &quot;NA&quot;),
            prop_no=count(twitter == &quot;No&quot;)/count(bachelor_graduate == &quot;Yes&quot; &amp; twitter != &quot;NA&quot;))</code></pre>
<pre><code>## # A tibble: 1 x 2
##   prop_yes prop_no
##      &lt;dbl&gt;   &lt;dbl&gt;
## 1    0.233   0.767</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Using the CI formula for proportions, please construct two 95% CIs for <code>bachelor_graduate</code> vs whether they use (Yes) and don’t (No) use twitter.</li>
</ol>
<pre class="r"><code>CI_twitter_grad_yes &lt;- gss_tidy %&gt;%
  filter(bachelor_graduate == &quot;Yes&quot;) %&gt;%
  summarize(NUM=count(twitter%in%c(&#39;Yes&#39;,&#39;No&#39;)),
            proportion_yes =count(twitter==&#39;Yes&#39;)/NUM,
            SD2=sqrt(proportion_yes*(1-proportion_yes)/NUM),
            upper=proportion_yes+SD2*1.96,
            lower=proportion_yes-SD2*1.96)

CI_twitter_grad_no &lt;- gss_tidy %&gt;%
  filter(bachelor_graduate == &quot;Yes&quot;) %&gt;%
  summarize(NUM=count(twitter%in%c(&#39;Yes&#39;,&#39;No&#39;)),
            proportion_no =count(twitter==&#39;No&#39;)/NUM,
            SD2=sqrt(proportion_no*(1-proportion_no)/NUM),
            upper=proportion_no+SD2*1.96,
            lower=proportion_no-SD2*1.96)

CI_twitter_grad_yes</code></pre>
<pre><code>## # A tibble: 1 x 5
##     NUM proportion_yes    SD2 upper lower
##   &lt;int&gt;          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   489          0.233 0.0191 0.271 0.196</code></pre>
<pre class="r"><code>CI_twitter_grad_no</code></pre>
<pre><code>## # A tibble: 1 x 5
##     NUM proportion_no    SD2 upper lower
##   &lt;int&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   489         0.767 0.0191 0.804 0.729</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Do these two Confidence Intervals overlap?
&gt;Clearly no, due to proportion split and the large sample size, reducing the standard error.</li>
</ol>
</div>
<div id="email-usage" class="section level2">
<h2>Email usage</h2>
<p>Can we estimate the <em>population</em> parameter on time spent on email weekly?</p>
<ol style="list-style-type: decimal">
<li>Create a new variable called <code>email</code> that combines <code>emailhr</code> and <code>emailmin</code> to reports the number of minutes the respondents spend on email weekly.</li>
<li>Visualise the distribution of this new variable. Find the mean and the median number of minutes respondents spend on email weekly. Is the mean or the median a better measure of the typical amoung of time Americans spend on email weekly? Why?</li>
</ol>
<pre class="r"><code>hrs_num &lt;- as.numeric(gss_tidy$emailhr)
min_num &lt;- as.numeric(gss_tidy$emailmin)
hrs_in_min = 60*hrs_num

gss_tidy &lt;-gss_tidy %&gt;% 
  mutate(email = hrs_in_min + min_num)

gss_tidy%&gt;% 
  ggplot(aes(x=email))+
  geom_histogram(bindwith =5,color= &quot;white&quot;)+
  labs(title = &quot;Americans spend up to 100 hours reading emails!!&quot;,
       subtitle = &quot;Distribution of time spent reading emails, weekly&quot;,
         x= &quot;Minutes spent reading emails&quot;, 
         y = &quot;Number of respondents&quot;)</code></pre>
<p><img src="/blogs/blog9_files/figure-html/unnamed-chunk-6-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code>gss_tidy %&gt;% 
  summarise(mean_email=mean(email,na.rm=TRUE),median_email =median(email,na.rm=TRUE))</code></pre>
<pre><code>## # A tibble: 1 x 2
##   mean_email median_email
##        &lt;dbl&gt;        &lt;dbl&gt;
## 1       417.          120</code></pre>
<pre class="r"><code>#Median better than mean as it does not take into account extreme values
#Think about the space between the bars</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Using the <code>infer</code> package, calculate a 95% bootstrap confidence interval for the mean amount of time Americans spend on email weekly. Interpret this interval in context of the data, reporting its endpoints in “humanized” units (e.g. instead of 108 minutes, report 1 hr and 8 minutes). If you get a result that seems a bit odd, discuss why you think this might be the case.</li>
<li>Would you expect a 99% confidence interval to be wider or narrower than the interval you calculated above? Explain your reasoning.</li>
</ol>
<pre class="r"><code>library(infer)
bootstrap_email&lt;- gss_tidy%&gt;% 
  specify(response= email) %&gt;% 
  generate(reps=1000, 
           type = &quot;bootstrap&quot;) %&gt;% 
  calculate(stat=&quot;mean&quot;) 
  
glimpse(bootstrap_email)</code></pre>
<pre><code>## Rows: 1,000
## Columns: 2
## $ replicate &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …
## $ stat      &lt;dbl&gt; 433, 450, 394, 401, 406, 416, 422, 410, 406, 419, 424, 416,…</code></pre>
<pre class="r"><code>ci_bootstarp_email &lt;- bootstrap_email %&gt;% 
  get_ci(level=0.95
      , type= &quot;percentile&quot;)

ci_bootstarp_email</code></pre>
<pre><code>## # A tibble: 1 x 2
##   lower_ci upper_ci
##      &lt;dbl&gt;    &lt;dbl&gt;
## 1     385.     449.</code></pre>
</div>
</div>
